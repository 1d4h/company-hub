// 헤더 정규화 테스트용 샘플 Excel 생성
const XLSX = require('xlsx');

const sampleData = [
  {
    '순번': 1,
    '횟수': 1,
    '접수일자': '2024-01-15',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '김철수',
    '전화번호': '010-1234-5678',
    '설치연월': '2023-12',  // 쉼표 없는 버전
    '열원': '전기',
    '주소': '서울특별시 강남구 역삼동 123',
    'AS접수내용': '온수 배관 수리 필요',
    '설치팀': 'A팀',
    '지역': '서울',
    '접수자': '홍길동',
    'AS결과': '점검중'
  },
  {
    '순번': 2,
    '횟수': 1,
    '접수일자': '2024-01-16',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '이영희',
    '전화번호': '010-2345-6789',
    '설치연월': '2023-11',
    '열원': '가스',
    '주소': '서울특별시 서초구 서초동 456',
    'AS접수내용': '보일러 점검 요청',
    '설치팀': 'B팀',
    '지역': '서울',
    '접수자': '김영수',
    'AS결과': '대기'
  },
  {
    '순번': 3,
    '횟수': 2,
    '접수일자': '2024-01-17',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '박민수',
    '전화번호': '010-3456-7890',
    '설치연월': '2023-10',
    '열원': '전기',
    '주소': '서울특별시 송파구 잠실동 789',
    'AS접수내용': '난방 불량',
    '설치팀': 'A팀',
    '지역': '서울',
    '접수자': '홍길동',
    'AS결과': '미완료'
  },
  {
    '순번': 4,
    '횟수': 1,
    '접수일자': '2024-01-18',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '최지연',
    '전화번호': '010-4567-8901',
    '설치연월': '2023-09',
    '열원': '가스',
    '주소': '서울특별시 마포구 공덕동 321',
    'AS접수내용': '온수 온도 조절 이상',
    '설치팀': 'B팀',
    '지역': '서울',
    '접수자': '김영수',
    'AS결과': '완료'
  },
  {
    '순번': 5,
    '횟수': 1,
    '접수일자': '2024-01-19',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '정우성',
    '전화번호': '010-5678-9012',
    '설치연월': '2024-01',
    '열원': '전기',
    '주소': '서울특별시 용산구 이태원동 654',
    'AS접수내용': '초기 점검 요청',
    '설치팀': 'A팀',
    '지역': '서울',
    '접수자': '홍길동',
    'AS결과': '대기'
  },
  {
    '순번': 6,
    '횟수': 1,
    '접수일자': '2024-01-20',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '강호동',
    '전화번호': '010-6789-0123',
    '설치연월': '2023-08',
    '열원': '전기',
    '주소': '경기도 성남시 분당구 정자동 123',
    'AS접수내용': '난방 효율 저하',
    '설치팀': 'C팀',
    '지역': '경기',
    '접수자': '이순신',
    'AS결과': '점검중'
  },
  {
    '순번': 7,
    '횟수': 1,
    '접수일자': '2024-01-21',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '유재석',
    '전화번호': '010-7890-1234',
    '설치연월': '2023-07',
    '열원': '가스',
    '주소': '경기도 고양시 일산동구 백석동 456',
    'AS접수내용': '보일러 소음 발생',
    '설치팀': 'C팀',
    '지역': '경기',
    '접수자': '이순신',
    'AS결과': '미완료'
  },
  {
    '순번': 8,
    '횟수': 2,
    '접수일자': '2024-01-22',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '박명수',
    '전화번호': '010-8901-2345',
    '설치연월': '2023-06',
    '열원': '전기',
    '주소': '인천광역시 남동구 구월동 789',
    'AS접수내용': '온수 온도 불안정',
    '설치팀': 'D팀',
    '지역': '인천',
    '접수자': '세종대왕',
    'AS결과': '완료'
  },
  {
    '순번': 9,
    '횟수': 1,
    '접수일자': '2024-01-23',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '하하',
    '전화번호': '010-9012-3456',
    '설치연월': '2023-05',
    '열원': '가스',
    '주소': '인천광역시 연수구 송도동 321',
    'AS접수내용': '난방 작동 불량',
    '설치팀': 'D팀',
    '지역': '인천',
    '접수자': '세종대왕',
    'AS결과': '대기'
  },
  {
    '순번': 10,
    '횟수': 1,
    '접수일자': '2024-01-24',
    '업체': '(주)테스트업체',
    '구분': 'A/S',
    '고객명': '노홍철',
    '전화번호': '010-0123-4567',
    '설치연월': '2024-01',
    '열원': '전기',
    '주소': '부산광역시 해운대구 우동 654',
    'AS접수내용': '신규 설치 점검',
    '설치팀': 'E팀',
    '지역': '부산',
    '접수자': '광개토대왕',
    'AS결과': '점검중'
  }
];

// Excel 워크북 생성
const wb = XLSX.utils.book_new();
const ws = XLSX.utils.json_to_sheet(sampleData);

// 컬럼 너비 설정
ws['!cols'] = [
  { wch: 6 },  // 순번
  { wch: 6 },  // 횟수
  { wch: 12 }, // 접수일자
  { wch: 15 }, // 업체
  { wch: 8 },  // 구분
  { wch: 10 }, // 고객명
  { wch: 15 }, // 전화번호
  { wch: 10 }, // 설치연월
  { wch: 8 },  // 열원
  { wch: 40 }, // 주소
  { wch: 30 }, // AS접수내용
  { wch: 10 }, // 설치팀
  { wch: 8 },  // 지역
  { wch: 12 }, // 접수자
  { wch: 10 }  // AS결과
];

XLSX.utils.book_append_sheet(wb, ws, '고객목록');

// 파일 저장
XLSX.writeFile(wb, 'sample-customers-clean.xlsx');

console.log('✅ 샘플 Excel 파일 생성 완료: sample-customers-clean.xlsx');
console.log('📊 총 고객 수:', sampleData.length);
console.log('🔍 헤더:', Object.keys(sampleData[0]).join(', '));
